syntax = "proto3";

package event;

option go_package =  "github.com/lzkking/edr/proto";

message Event {
  string agent_id = 1;
  string event_id = 2;
  string event_type = 3;
  int64 timestamp = 4;
  bytes data = 5;
}

message Command {
  string agent_id = 1;
  string event_id = 2;
  string event_type = 3;
  int64  timestamp = 4;
  bytes data = 5;
  FileInfo file_info = 6;
}

message FileInfo {
  repeated string url = 1;
  string sign = 2;
  string version = 3;
  string file_name =4;
}

service Service {
  rpc Transfer(stream Event) returns (stream Command);
}